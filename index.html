<!DOCTYPE html>
<html lang="en">
<head>
  <title> Smart Oil Lamp </title>
  
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js" type="text/javascript"></script>

</head>

<body style="background-image:url('oil.jpg')">
	<br>
	<br>
	<br>
	<br>
	<br>
	<br>
	<center>
	<h2><b> Smart Oil Lamp </b></h2>
	<br>
	<p> Please click a button to light the oil lamp </p>
	<br>
	<button id="L1" onclick="ignite1()" class="btn btn-warning"> Lamp 1 </button>
	<button id="L2" onclick="ignite2()" class="btn btn-warning"> Lamp 2 </button>
	<button id="L3" onclick="ignite3()" class="btn btn-warning"> Lamp 3 </button>
	<button id="L4" onclick="ignite4()" class="btn btn-warning"> Lamp 4 </button>
	<button id="L5" onclick="ignite5()" class="btn btn-warning"> Lamp 5 </button>
	
	
	
	
	<script>
		function ignite1() {
		// Create a client instance
		client = new Paho.MQTT.Client("iot.eclipse.org",80,"/ws", "clientId");

		// set callback handlers
		client.onConnectionLost = onConnectionLost;
		client.onMessageArrived = onMessageArrived;

		// connect the client
		client.connect({onSuccess:onConnect1});

		}
		
		function ignite2() {
		// Create a client instance
		client = new Paho.MQTT.Client("iot.eclipse.org",80,"/ws", "clientId");

		// set callback handlers
		client.onConnectionLost = onConnectionLost;
		client.onMessageArrived = onMessageArrived;

		// connect the client
		client.connect({onSuccess:onConnect2});

		}
		
		function ignite3() {
		// Create a client instance
		client = new Paho.MQTT.Client("iot.eclipse.org",80,"/ws", "clientId");

		// set callback handlers
		client.onConnectionLost = onConnectionLost;
		client.onMessageArrived = onMessageArrived;

		// connect the client
		client.connect({onSuccess:onConnect3});

		}
		
		function ignite4() {
		// Create a client instance
		client = new Paho.MQTT.Client("iot.eclipse.org",80,"/ws", "clientId");

		// set callback handlers
		client.onConnectionLost = onConnectionLost;
		client.onMessageArrived = onMessageArrived;

		// connect the client
		client.connect({onSuccess:onConnect4});

		}
		
		function ignite5() {
		// Create a client instance
		client = new Paho.MQTT.Client("iot.eclipse.org",80,"/ws", "clientId");

		// set callback handlers
		client.onConnectionLost = onConnectionLost;
		client.onMessageArrived = onMessageArrived;

		// connect the client
		client.connect({onSuccess:onConnec5});

		}
		
		
		
		// called when the client connects
		function onConnect1() {
		  // Once a connection has been made, make a subscription and send a message.
		  console.log("onConnect");
		  client.subscribe("jplamp");
		  message = new Paho.MQTT.Message("1");
		  message.destinationName = "jplamp";
		  client.send(message);
		}
		
		function onConnect2() {
		  // Once a connection has been made, make a subscription and send a message.
		  console.log("onConnect");
		  client.subscribe("jplamp");
		  message = new Paho.MQTT.Message("2");
		  message.destinationName = "jplamp";
		  client.send(message);
		}
		
		function onConnect3() {
		  // Once a connection has been made, make a subscription and send a message.
		  console.log("onConnect");
		  client.subscribe("jplamp");
		  message = new Paho.MQTT.Message("3");
		  message.destinationName = "jplamp";
		  client.send(message);
		}
		
		function onConnect4() {
		  // Once a connection has been made, make a subscription and send a message.
		  console.log("onConnect");
		  client.subscribe("jplamp");
		  message = new Paho.MQTT.Message("4");
		  message.destinationName = "jplamp";
		  client.send(message);
		}
		
		function onConnect5() {
		  // Once a connection has been made, make a subscription and send a message.
		  console.log("onConnect");
		  client.subscribe("jplamp");
		  message = new Paho.MQTT.Message("5");
		  message.destinationName = "jplamp";
		  client.send(message);
		}

		
		
		// called when the client loses its connection
		function onConnectionLost(responseObject) {
		  if (responseObject.errorCode !== 0) {
			console.log("onConnectionLost:"+responseObject.errorMessage);
		  }
		}

		// called when a message arrives
		function onMessageArrived(message) {
		  console.log("onMessageArrived:"+message.payloadString);
		  alert(message.payloadString);
			  if (message.payloadString == "1ok"){
				console.log("message from the lamp:"+message.payloadString);
				document.getElementById("L1").disabled = true;
				}
			  if (message.payloadString == "2ok"){
				console.log("message from the lamp:"+message.payloadString);
				document.getElementById("L2").disabled = true;
				}
			  if (message.payloadString == "3ok"){
				console.log("message from the lamp:"+message.payloadString);
				document.getElementById("L3").disabled = true;
				}
			  if (message.payloadString == "4ok"){
				console.log("message from the lamp:"+message.payloadString);
				document.getElementById("L4").disabled = true;
				}
			  if (message.payloadString == "5ok"){
				console.log("message from the lamp:"+message.payloadString);
				document.getElementById("L5").disabled = true;
				}
		}
		
		
	 
	</script>

</body>

</html>